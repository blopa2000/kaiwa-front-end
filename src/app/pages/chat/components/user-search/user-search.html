<div class="p-4 border-b border-gray-200 relative">
  <div class="relative">
    <input
      type="text"
      [formControl]="searchControl"
      placeholder="Buscar Usuarios"
      class="w-full px-4 py-2.5 pl-10 rounded-lg bg-gray-50 border border-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white transition"
    />
    <svg
      class="w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"
      fill="none"
      stroke="currentColor"
      viewBox="0 0 24 24"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        stroke-width="2"
        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
      />
    </svg>
  </div>

  @if (loading()) {
    <div
      class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-b-lg border border-t-0 border-gray-200 p-3 text-sm text-gray-500 z-10"
    >
      Buscando...
    </div>
  }

  @if (!loading() && results().length > 0) {
    <div
      class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-b-lg border border-t-0 border-gray-200 z-10 max-h-80 overflow-y-auto"
    >
      @for (user of results(); track user.id) {
        <div
          class="p-3 hover:bg-gray-50 cursor-pointer transition border-b border-gray-200 last:border-b-0"
          (click)="selectUser(user)"
        >
          <div class="flex items-center gap-3">
            <img
              [src]="user.photo || 'avatar.jpg'"
              class="w-10 h-10 rounded-full object-cover"
              alt="avatar"
            />
            <div>
              <div class="font-medium text-gray-900">{{ user.username }}</div>
              <div class="text-sm text-gray-500">{{ user.first_name }} {{ user.last_name }}</div>
            </div>
          </div>
        </div>
      }
    </div>
  }

  @if (!loading() && queryLength >= 2 && results().length === 0) {
    <div
      class="absolute top-full left-0 right-0 bg-white shadow-lg rounded-b-lg border border-t-0 border-gray-200 p-4 text-sm text-gray-500 z-10"
    >
      No se encontraron usuarios
    </div>
  }
</div>
